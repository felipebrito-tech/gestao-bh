let messageAlert=()=>{alert("Primeiro gere um relatório prévio (preferêncialmente, desde o primeiro dia do mês), só depois clique no botão Calcular!")},horaEmMinutos=e=>{let[a,t]=e.split(":").map((e=>parseInt(e)));return t+60*a},minutosEmHorasTexto=e=>{let a=e%60,t=(e-a)/60;return a=a<10?"0"+a:a,t=t<10?"0"+t:t,t+":"+a},totalDeHorasRealizadas=()=>{let e=document.getElementById("bottomRelatorio");return e?e.querySelectorAll("div i")[1]:null},exibirAvaliacaoBancoDeHoras=e=>{let a=document.createElement("i");if(a.classList.add("estadoBancoDeHoras"),a.innerText=" | "+e,totalDeHorasRealizadas()){let e=totalDeHorasRealizadas().parentNode;null!=e.querySelector(".estadoBancoDeHoras")&&e.removeChild(e.querySelector(".estadoBancoDeHoras")),e.appendChild(a)}else messageAlert()},avaliarBancoDeHoras=(e,a)=>{let t=horaEmMinutos(e),o=horaEmMinutos(a);if(t>o){let e=minutosEmHorasTexto(t-o);exibirAvaliacaoBancoDeHoras("Você está devendo "+e+" horas neste mês.")}else if(t<o){let e=minutosEmHorasTexto(o-t);exibirAvaliacaoBancoDeHoras("Você está com crédito de "+e+" horas neste mês.")}else exibirAvaliacaoBancoDeHoras("Você está em dia com seu Banco de Horas.")},totalizarHorasDia=(e,a,t,o)=>horaEmMinutos(a)-horaEmMinutos(e)+(horaEmMinutos(o)-horaEmMinutos(t)),contarDiasNaoRegistrados=e=>{let a=0;for(let t of e)"ND"==t.value&&a++;return a},totalHorasDevidas=(e,a)=>8*(e-a),salvarPonto=()=>{0==document.getElementsByClassName("entrada").length&&transformarTabela();let e=document.querySelectorAll(".total"),a=0;for(let t of e){let e=t.parentNode,o=e.querySelector(".entrada input").value,r=e.querySelector(".inicioAlmoco input").value,l=e.querySelector(".fimAlmoco input").value,n=e.querySelector(".saida input").value;if(o.includes(":")&&r.includes(":")&&l.includes(":")&&n.includes(":")){let e=totalizarHorasDia(o,r,l,n);a+=e,t.querySelector("input").value=minutosEmHorasTexto(e)}}if(totalDeHorasRealizadas()){totalDeHorasRealizadas().innerText=minutosEmHorasTexto(a);let e=document.querySelectorAll(".total input");avaliarBancoDeHoras(totalHorasDevidas(e.length,contarDiasNaoRegistrados(e))+":00",minutosEmHorasTexto(a))}else messageAlert()},getCpfUsuario=()=>document.querySelectorAll(".profile-pic span")[0].innerText,buildPonto=e=>({data:e.querySelector(".data").innerText,entrada:e.querySelector(".entrada input").value,inicioAlmoco:e.querySelector(".inicioAlmoco input").value,fimAlmoco:e.querySelector(".fimAlmoco input").value,saida:e.querySelector(".saida input").value}),carregarPonto=(e,a)=>{e.querySelector(".data").innerText=a.data,e.querySelector(".entrada input").value=a.entrada,e.querySelector(".inicioAlmoco input").value=a.inicioAlmoco,e.querySelector(".fimAlmoco input").value=a.fimAlmoco,e.querySelector(".saida input").value=a.saida},inserirButtonSalvar=e=>{let a=document.createElement("button");a.innerText="Salvar",a.classList.add("salvar","btn","btnPCSStyle","mr-1"),a.style="padding: 0.5em;border-color: darkgray;border-radius: 50%;font-weight: normal;font-size: 0.65rem;background-color: darkgreen;",e.appendChild(a),a.addEventListener("click",(()=>{let a=buildPonto(e.parentNode),t=getCpfUsuario()+a.data;localStorage.setItem(t,JSON.stringify(a)),calcularBancoDeHoras()}))},carregarPontosSalvos=()=>{document.querySelectorAll(".data").forEach((e=>{let a=JSON.parse(localStorage.getItem(getCpfUsuario()+e.innerText));a&&carregarPonto(e.parentNode,a)}))},transformarTabela=()=>{let e=document.querySelectorAll(".AtenaMvcGrid tbody td");for(let a=0;a<e.length;a++){let t=e[a];if(a%7==0&&t.classList.add("data"),a%7==2&&t.classList.add("entrada"),a%7==3&&t.classList.add("inicioAlmoco"),a%7==4&&t.classList.add("fimAlmoco"),a%7==5&&t.classList.add("saida"),a%7>1){let e=t.innerText,a="<input type='text' />";t.setHTML(a),t.querySelectorAll("input")[0].value=e,t.querySelectorAll("input")[0].style="width: inherit; border-style: none; background-color: transparent;"}a%7==6&&(t.classList.add("total"),inserirButtonSalvar(t))}carregarPontosSalvos()},calcularBancoDeHoras=()=>{0==document.getElementsByClassName("entrada").length&&transformarTabela();let e=document.querySelectorAll(".total"),a=0;for(let t of e){let e=t.parentNode,o=e.querySelector(".entrada input").value,r=e.querySelector(".inicioAlmoco input").value,l=e.querySelector(".fimAlmoco input").value,n=e.querySelector(".saida input").value;if(o.includes(":")&&r.includes(":")&&l.includes(":")&&n.includes(":")){let e=totalizarHorasDia(o,r,l,n);a+=e,t.querySelector("input").value=minutosEmHorasTexto(e)}}if(totalDeHorasRealizadas()){totalDeHorasRealizadas().innerText=minutosEmHorasTexto(a);let e=document.querySelectorAll(".total input");avaliarBancoDeHoras(totalHorasDevidas(e.length,contarDiasNaoRegistrados(e))+":00",minutosEmHorasTexto(a))}else messageAlert()},removeOldButtonIfExists=()=>{let e=document.getElementById("calcular");e&&e.parentNode.removeChild(e)},inserirButtonCalcular=()=>{removeOldButtonIfExists();let e=document.createElement("button");e.id="calcular",e.innerText="Calcular",e.classList.add("btn","btnPCSStyle","mr-1"),e.style="padding: 0.5em;border-color: darkgray;",document.getElementById("google_translate_element").parentNode.insertBefore(e,document.getElementById("google_translate_element")),e.addEventListener("click",calcularBancoDeHoras)};inserirButtonCalcular();