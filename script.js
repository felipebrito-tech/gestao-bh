let messageAlert=()=>{alert("Primeiro gere um relatório prévio (preferêncialmente, desde o primeiro dia do mês), só depois clique no botão Calcular!")},horaEmMinutos=e=>{let[t,a]=e.split(":").map((e=>parseInt(e)));return a+60*t},minutosEmHorasTexto=e=>{let t=e%60,a=(e-t)/60;return t=t<10?"0"+t:t,a=a<10?"0"+a:a,a+":"+t},totalDeHorasRealizadas=()=>{let e=document.getElementById("bottomRelatorio");return e?e.querySelectorAll("div i")[1]:null},exibirAvaliacaoBancoDeHoras=e=>{let t=document.createElement("i");if(t.classList.add("estadoBancoDeHoras"),t.innerText=" | "+e,totalDeHorasRealizadas()){let e=totalDeHorasRealizadas().parentNode;null!=e.querySelector(".estadoBancoDeHoras")&&e.removeChild(e.querySelector(".estadoBancoDeHoras")),e.appendChild(t)}else messageAlert()},avaliarBancoDeHoras=(e,t)=>{let a=horaEmMinutos(e),o=horaEmMinutos(t);if(a>o){let e=minutosEmHorasTexto(a-o);exibirAvaliacaoBancoDeHoras("Você está devendo "+e+" horas neste mês.")}else if(a<o){let e=minutosEmHorasTexto(o-a);exibirAvaliacaoBancoDeHoras("Você está com crédito de "+e+" horas neste mês.")}else exibirAvaliacaoBancoDeHoras("Você está em dia com seu Banco de Horas.")},totalizarHorasDia=(e,t,a,o)=>horaEmMinutos(t)-horaEmMinutos(e)+(horaEmMinutos(o)-horaEmMinutos(a)),contarDiasNaoRegistrados=e=>{let t=0;for(let a of e)"ND"==a.value&&t++;return t},totalHorasDevidas=(e,t)=>8*(e-t),salvarPonto=()=>{0==document.getElementsByClassName("entrada").length&&transformarTabela();let e=document.querySelectorAll(".total"),t=0;for(let a of e){let e=a.parentNode,o=e.querySelector(".entrada input").value,r=e.querySelector(".inicioAlmoco input").value,l=e.querySelector(".fimAlmoco input").value,i=e.querySelector(".saida input").value;if(o.includes(":")&&r.includes(":")&&l.includes(":")&&i.includes(":")){let e=totalizarHorasDia(o,r,l,i);t+=e,a.querySelector("input").value=minutosEmHorasTexto(e)}}if(totalDeHorasRealizadas()){totalDeHorasRealizadas().innerText=minutosEmHorasTexto(t);let e=document.querySelectorAll(".total input");avaliarBancoDeHoras(totalHorasDevidas(e.length,contarDiasNaoRegistrados(e))+":00",minutosEmHorasTexto(t))}else messageAlert()},getCpfUsuario=()=>document.querySelectorAll(".profile-pic span")[0].innerText,buildPonto=e=>({data:e.querySelector(".data").innerText,entrada:e.querySelector(".entrada input").value,inicioAlmoco:e.querySelector(".inicioAlmoco input").value,fimAlmoco:e.querySelector(".fimAlmoco input").value,saida:e.querySelector(".saida input").value}),carregarPonto=(e,t)=>{e.querySelector(".data").innerText=t.data,e.querySelector(".entrada input").value=t.entrada,e.querySelector(".inicioAlmoco input").value=t.inicioAlmoco,e.querySelector(".fimAlmoco input").value=t.fimAlmoco,e.querySelector(".saida input").value=t.saida},inserirButtonSalvar=e=>{let t=document.createElement("i");t.classList.add("salvar","fa","fa-save","mr-1"),t.style="cursor: pointer",e.appendChild(t),t.addEventListener("click",(()=>{let t=buildPonto(e.parentNode),a=getCpfUsuario()+t.data;localStorage.setItem(a,JSON.stringify(t)),inserirButtonExcluir(e),calcularBancoDeHoras()}))},inserirButtonExcluir=e=>{let t=document.createElement("i");t.classList.add("excluir","fa","fa-trash"),t.style="cursor: pointer; padding: 0 3",e.appendChild(t),t.addEventListener("click",(()=>{let a=buildPonto(e.parentNode),o=getCpfUsuario()+a.data;localStorage.removeItem(o),e.removeChild(t)}))},carregarPontosSalvos=()=>{document.querySelectorAll(".data").forEach((e=>{let t=getCpfUsuario()+e.innerText,a=JSON.parse(localStorage.getItem(t));a&&(carregarPonto(e.parentNode,a),inserirButtonExcluir(e.parentNode.querySelector(".total")))}))},transformarTabela=()=>{let e=document.querySelectorAll(".AtenaMvcGrid tbody td");for(let t=0;t<e.length;t++){let a=e[t];if(t%7==0&&a.classList.add("data"),t%7==2&&a.classList.add("entrada"),t%7==3&&a.classList.add("inicioAlmoco"),t%7==4&&a.classList.add("fimAlmoco"),t%7==5&&a.classList.add("saida"),t%7>1){let e=a.innerText,t="<input type='text' />";a.setHTML(t),a.querySelectorAll("input")[0].value=e,a.querySelectorAll("input")[0].style="width: inherit; border-style: none; background-color: transparent;"}t%7==6&&(a.classList.add("total"),inserirButtonSalvar(a))}carregarPontosSalvos()},calcularBancoDeHoras=()=>{0==document.getElementsByClassName("entrada").length&&transformarTabela();let e=document.querySelectorAll(".total"),t=0;for(let a of e){let e=a.parentNode,o=e.querySelector(".entrada input").value,r=e.querySelector(".inicioAlmoco input").value,l=e.querySelector(".fimAlmoco input").value,i=e.querySelector(".saida input").value;if(o.includes(":")&&r.includes(":")&&l.includes(":")&&i.includes(":")){let e=totalizarHorasDia(o,r,l,i);t+=e,a.querySelector("input").value=minutosEmHorasTexto(e)}}if(totalDeHorasRealizadas()){totalDeHorasRealizadas().innerText=minutosEmHorasTexto(t);let e=document.querySelectorAll(".total input");avaliarBancoDeHoras(totalHorasDevidas(e.length,contarDiasNaoRegistrados(e))+":00",minutosEmHorasTexto(t))}else messageAlert()},removeOldButtonIfExists=()=>{let e=document.getElementById("calcular");e&&e.parentNode.removeChild(e)},inserirButtonCalcular=()=>{removeOldButtonIfExists();let e=document.createElement("button");e.id="calcular",e.innerText="Calcular",e.classList.add("btn","btnPCSStyle","mr-1"),e.style="padding: 0.5em;border-color: darkgray;",document.getElementById("google_translate_element").parentNode.insertBefore(e,document.getElementById("google_translate_element")),e.addEventListener("click",calcularBancoDeHoras)};inserirButtonCalcular();